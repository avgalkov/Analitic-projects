SELECT toStartOfDay(toDateTime(time)) AS __timestamp,
       count(DISTINCT user_id) AS "COUNT_DISTINCT(user_id)"
FROM simulator_20221220.feed_actions
WHERE time >= toDateTime('2022-12-01 00:00:00')
  AND time < toDateTime('2023-01-01 00:00:00')
GROUP BY toStartOfDay(toDateTime(time))
ORDER BY "COUNT_DISTINCT(user_id)" DESC
LIMIT 50000;

<img src="https://github.com/avgalkov/Analytic-projects/blob/main/social%20app/assets/DAU.jpg"/>